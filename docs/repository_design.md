# –ü—Ä–æ–µ–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–µ–≤

## –ü—Ä–∏–Ω—Ü–∏–ø—ã –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–µ–≤ –≤ DDD

### 1. Aggregate Root (–ö–æ—Ä–µ–Ω—å –∞–≥—Ä–µ–≥–∞—Ç–∞)

**–ì–ª–∞–≤–Ω–æ–µ –ø—Ä–∞–≤–∏–ª–æ:** –†–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π —Å–æ–∑–¥–∞–µ—Ç—Å—è –¥–ª—è **Aggregate Root**, –∞ –Ω–µ –¥–ª—è –∫–∞–∂–¥–æ–π —Å—É—â–Ω–æ—Å—Ç–∏.

**Aggregate Root** - —ç—Ç–æ –≥–ª–∞–≤–Ω–∞—è —Å—É—â–Ω–æ—Å—Ç—å –∞–≥—Ä–µ–≥–∞—Ç–∞, –∫–æ—Ç–æ—Ä–∞—è:
- –ò–º–µ–µ—Ç –≥–ª–æ–±–∞–ª—å–Ω—É—é –∏–¥–µ–Ω—Ç–∏—á–Ω–æ—Å—Ç—å (—É–Ω–∏–∫–∞–ª—å–Ω—ã–π ID)
- –£–ø—Ä–∞–≤–ª—è–µ—Ç –∂–∏–∑–Ω–µ–Ω–Ω—ã–º —Ü–∏–∫–ª–æ–º –¥–æ—á–µ—Ä–Ω–∏—Ö —Å—É—â–Ω–æ—Å—Ç–µ–π
- –û–±–µ—Å–ø–µ—á–∏–≤–∞–µ—Ç —Ü–µ–ª–æ—Å—Ç–Ω–æ—Å—Ç—å –¥–∞–Ω–Ω—ã—Ö –≤–Ω—É—Ç—Ä–∏ –∞–≥—Ä–µ–≥–∞—Ç–∞
- –Ø–≤–ª—è–µ—Ç—Å—è —Ç–æ—á–∫–æ–π –≤—Ö–æ–¥–∞ –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å –∞–≥—Ä–µ–≥–∞—Ç–æ–º

---

## –ê–Ω–∞–ª–∏–∑ –Ω–∞—à–µ–≥–æ –ø—Ä–æ–µ–∫—Ç–∞

### Aggregate Roots (–Ω—É–∂–Ω—ã —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–∏):

#### 1. **Task** - –≥–ª–∞–≤–Ω—ã–π –∞–≥—Ä–µ–≥–∞—Ç ‚úÖ
```
Task (Aggregate Root)
‚îú‚îÄ‚îÄ Comment (–¥–æ—á–µ—Ä–Ω—è—è —Å—É—â–Ω–æ—Å—Ç—å)
‚îú‚îÄ‚îÄ Attachment (–¥–æ—á–µ—Ä–Ω—è—è —Å—É—â–Ω–æ—Å—Ç—å)
‚îú‚îÄ‚îÄ TimeLog (–¥–æ—á–µ—Ä–Ω—è—è —Å—É—â–Ω–æ—Å—Ç—å)
‚îî‚îÄ‚îÄ Activity (–¥–æ—á–µ—Ä–Ω—è—è —Å—É—â–Ω–æ—Å—Ç—å)
```

**–†–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π:** `TaskRepository` ‚úÖ

**–ü–æ—á–µ–º—É Task - Aggregate Root:**
- –£–ø—Ä–∞–≤–ª—è–µ—Ç –∂–∏–∑–Ω–µ–Ω–Ω—ã–º —Ü–∏–∫–ª–æ–º Comment, Attachment, TimeLog, Activity
- –û–±–µ—Å–ø–µ—á–∏–≤–∞–µ—Ç —Ü–µ–ª–æ—Å—Ç–Ω–æ—Å—Ç—å –¥–∞–Ω–Ω—ã—Ö (–Ω–∞–ø—Ä–∏–º–µ—Ä, –Ω–µ–ª—å–∑—è —Å–æ–∑–¥–∞—Ç—å Comment –±–µ–∑ Task)
- –ò–º–µ–µ—Ç –≥–ª–æ–±–∞–ª—å–Ω—É—é –∏–¥–µ–Ω—Ç–∏—á–Ω–æ—Å—Ç—å

#### 2. **User** - –Ω–µ–∑–∞–≤–∏—Å–∏–º—ã–π –∞–≥—Ä–µ–≥–∞—Ç ‚úÖ
```
User (Aggregate Root)
‚îî‚îÄ‚îÄ (–Ω–µ—Ç –¥–æ—á–µ—Ä–Ω–∏—Ö —Å—É—â–Ω–æ—Å—Ç–µ–π)
```

**–†–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π:** `UserRepository` ‚úÖ

**–ü–æ—á–µ–º—É User - Aggregate Root:**
- –ù–µ–∑–∞–≤–∏—Å–∏–º–∞—è —Å—É—â–Ω–æ—Å—Ç—å
- –ò–º–µ–µ—Ç –≥–ª–æ–±–∞–ª—å–Ω—É—é –∏–¥–µ–Ω—Ç–∏—á–Ω–æ—Å—Ç—å
- –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥—Ä—É–≥–∏–º–∏ –∞–≥—Ä–µ–≥–∞—Ç–∞–º–∏ (Task.creator_id, Task.assignee_id)

---

### –î–æ—á–µ—Ä–Ω–∏–µ —Å—É—â–Ω–æ—Å—Ç–∏ (—á–∞—Å—Ç–∏ –∞–≥—Ä–µ–≥–∞—Ç–∞ Task):

#### 3. **Comment** - —á–∞—Å—Ç—å –∞–≥—Ä–µ–≥–∞—Ç–∞ Task
**–†–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π:** `CommentRepository` ‚ö†Ô∏è

**–ù—É–∂–µ–Ω –ª–∏ –æ—Ç–¥–µ–ª—å–Ω—ã–π —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π?**
- ‚úÖ **–î–ê**, –µ—Å–ª–∏ –Ω—É–∂–Ω–æ –∏—Å–∫–∞—Ç—å –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏ –Ω–µ–∑–∞–≤–∏—Å–∏–º–æ –æ—Ç –∑–∞–¥–∞—á–∏
  - –ù–∞–ø—Ä–∏–º–µ—Ä: "–ù–∞–π—Ç–∏ –≤—Å–µ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è"
  - –ù–∞–ø—Ä–∏–º–µ—Ä: "–ù–∞–π—Ç–∏ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏ –ø–æ –∫–ª—é—á–µ–≤—ã–º —Å–ª–æ–≤–∞–º" (FR-6.1)
- ‚ùå **–ù–ï–¢**, –µ—Å–ª–∏ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏ –≤—Å–µ–≥–¥–∞ –∑–∞–≥—Ä—É–∂–∞—é—Ç—Å—è —á–µ—Ä–µ–∑ Task

**–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è:** –û—Å—Ç–∞–≤–∏—Ç—å `CommentRepository` –¥–ª—è –ø–æ–∏—Å–∫–∞ –∏ —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏

#### 4. **Attachment** - —á–∞—Å—Ç—å –∞–≥—Ä–µ–≥–∞—Ç–∞ Task
**–†–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π:** `AttachmentRepository` ‚ö†Ô∏è

**–ù—É–∂–µ–Ω –ª–∏ –æ—Ç–¥–µ–ª—å–Ω—ã–π —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π?**
- ‚úÖ **–î–ê**, –µ—Å–ª–∏ –Ω—É–∂–Ω–æ –∏—Å–∫–∞—Ç—å —Ñ–∞–π–ª—ã –Ω–µ–∑–∞–≤–∏—Å–∏–º–æ
  - –ù–∞–ø—Ä–∏–º–µ—Ä: "–ù–∞–π—Ç–∏ –≤—Å–µ —Ñ–∞–π–ª—ã –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è"
  - –ù–∞–ø—Ä–∏–º–µ—Ä: "–ù–∞–π—Ç–∏ —Ñ–∞–π–ª—ã –ø–æ —Ç–∏–ø—É"
- ‚ùå **–ù–ï–¢**, –µ—Å–ª–∏ —Ñ–∞–π–ª—ã –≤—Å–µ–≥–¥–∞ –∑–∞–≥—Ä—É–∂–∞—é—Ç—Å—è —á–µ—Ä–µ–∑ Task

**–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è:** –û—Å—Ç–∞–≤–∏—Ç—å `AttachmentRepository` –¥–ª—è –ø–æ–∏—Å–∫–∞

#### 5. **TimeLog** - —á–∞—Å—Ç—å –∞–≥—Ä–µ–≥–∞—Ç–∞ Task
**–†–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π:** `TimeLogRepository` ‚ö†Ô∏è

**–ù—É–∂–µ–Ω –ª–∏ –æ—Ç–¥–µ–ª—å–Ω—ã–π —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π?**
- ‚úÖ **–î–ê**, –µ—Å–ª–∏ –Ω—É–∂–Ω–æ:
  - –°—É–º–º–∏—Ä–æ–≤–∞—Ç—å –≤—Ä–µ–º—è –ø–æ –∑–∞–¥–∞—á–∞–º (FR-2.2)
  - –ò—Å–∫–∞—Ç—å –∑–∞–ø–∏—Å–∏ –≤—Ä–µ–º–µ–Ω–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
  - –ê–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å –∑–∞—Ç—Ä–∞—Ç—ã –≤—Ä–µ–º–µ–Ω–∏
- ‚ùå **–ù–ï–¢**, –µ—Å–ª–∏ –∑–∞–ø–∏—Å–∏ –≤—Ä–µ–º–µ–Ω–∏ –≤—Å–µ–≥–¥–∞ –∑–∞–≥—Ä—É–∂–∞—é—Ç—Å—è —á–µ—Ä–µ–∑ Task

**–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è:** –û—Å—Ç–∞–≤–∏—Ç—å `TimeLogRepository` –¥–ª—è –∞–Ω–∞–ª–∏—Ç–∏–∫–∏

#### 6. **Activity** - —á–∞—Å—Ç—å –∞–≥—Ä–µ–≥–∞—Ç–∞ Task
**–†–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π:** `ActivityRepository` ‚ö†Ô∏è

**–ù—É–∂–µ–Ω –ª–∏ –æ—Ç–¥–µ–ª—å–Ω—ã–π —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π?**
- ‚úÖ **–î–ê**, –æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ –¥–ª—è:
  - –ü—Ä–æ—Å–º–æ—Ç—Ä–∞ –∏—Å—Ç–æ—Ä–∏–∏ –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏ –∑–∞–¥–∞—á–∏ (FR-7.2)
  - –ü–æ–∏—Å–∫–∞ –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
  - –ê—É–¥–∏—Ç–∞ –∏ –æ—Ç—á–µ—Ç–Ω–æ—Å—Ç–∏
- ‚ùå **–ù–ï–¢**, –µ—Å–ª–∏ –∏—Å—Ç–æ—Ä–∏—è –≤—Å–µ–≥–¥–∞ –∑–∞–≥—Ä—É–∂–∞–µ—Ç—Å—è —á–µ—Ä–µ–∑ Task

**–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è:** –û—Å—Ç–∞–≤–∏—Ç—å `ActivityRepository` –¥–ª—è audit log

---

### –°–ø–µ—Ü–∏–∞–ª—å–Ω—ã–µ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å—ã:

#### 7. **AuthStorage** - –Ω–µ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π! ‚ö†Ô∏è
**–§–∞–π–ª:** `auth_storage.py`

**–ß—Ç–æ —ç—Ç–æ:**
- –≠—Ç–æ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å –¥–ª—è —Ö—Ä–∞–Ω–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏
- –ù–µ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π –¥–æ–º–µ–Ω–Ω–æ–π –º–æ–¥–µ–ª–∏
- –ú–æ–∂–µ—Ç —Ö—Ä–∞–Ω–∏—Ç—å: —Ç–æ–∫–µ–Ω—ã, —Å–µ—Å—Å–∏–∏, refresh tokens

**–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è:** –ü–µ—Ä–µ–∏–º–µ–Ω–æ–≤–∞—Ç—å –∏–ª–∏ –æ—Å—Ç–∞–≤–∏—Ç—å –∫–∞–∫ –µ—Å—Ç—å, –Ω–æ –ø–æ–Ω–∏–º–∞—Ç—å, —á—Ç–æ —ç—Ç–æ –Ω–µ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π Entity

---

## –ò—Ç–æ–≥–æ–≤—ã–π —Å–ø–∏—Å–æ–∫ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–µ–≤

### ‚úÖ –û–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–µ (Aggregate Roots):

1. **TaskRepository** - –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å –∑–∞–¥–∞—á–∞–º–∏
   - –û—Å–Ω–æ–≤–Ω—ã–µ –æ–ø–µ—Ä–∞—Ü–∏–∏: save, get_by_id, find_all, delete
   - –ü–æ–∏—Å–∫ –ø–æ —Ñ–∏–ª—å—Ç—Ä–∞–º (FR-6.1): —Å—Ç–∞—Ç—É—Å, –∏—Å–ø–æ–ª–Ω–∏—Ç–µ–ª—å, –¥–∞—Ç–∞, –∫–ª—é—á–µ–≤—ã–µ —Å–ª–æ–≤–∞

2. **UserRepository** - –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º–∏
   - –û—Å–Ω–æ–≤–Ω—ã–µ –æ–ø–µ—Ä–∞—Ü–∏–∏: save, get_by_id, find_by_email, find_all

### ‚ö†Ô∏è –û–ø—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–µ (–¥–ª—è –ø–æ–∏—Å–∫–∞ –∏ –∞–Ω–∞–ª–∏—Ç–∏–∫–∏):

3. **CommentRepository** - –¥–ª—è –ø–æ–∏—Å–∫–∞ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–µ–≤
   - –ü–æ–∏—Å–∫ –ø–æ –∑–∞–¥–∞—á–µ (—á–µ—Ä–µ–∑ Task —Ç–æ–∂–µ –º–æ–∂–Ω–æ)
   - –ü–æ–∏—Å–∫ –ø–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é
   - –ü–æ–∏—Å–∫ –ø–æ –∫–ª—é—á–µ–≤—ã–º —Å–ª–æ–≤–∞–º (FR-6.1)

4. **AttachmentRepository** - –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å —Ñ–∞–π–ª–∞–º–∏
   - –ü–æ–∏—Å–∫ –ø–æ –∑–∞–¥–∞—á–µ
   - –ü–æ–∏—Å–∫ –ø–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é
   - –ü—Ä–æ–≤–µ—Ä–∫–∞ –ª–∏–º–∏—Ç–∞ —Ñ–∞–π–ª–æ–≤ (FR-4.1)

5. **TimeLogRepository** - –¥–ª—è –∞–Ω–∞–ª–∏—Ç–∏–∫–∏ –≤—Ä–µ–º–µ–Ω–∏
   - –°—É–º–º–∏—Ä–æ–≤–∞–Ω–∏–µ –≤—Ä–µ–º–µ–Ω–∏ –ø–æ –∑–∞–¥–∞—á–µ (FR-2.2)
   - –ü–æ–∏—Å–∫ –∑–∞–ø–∏—Å–µ–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
   - –ê–Ω–∞–ª–∏—Ç–∏–∫–∞ –∑–∞—Ç—Ä–∞—Ç –≤—Ä–µ–º–µ–Ω–∏

6. **ActivityRepository** - –¥–ª—è audit log
   - –ü–æ–ª—É—á–µ–Ω–∏–µ –∏—Å—Ç–æ—Ä–∏–∏ –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏ –∑–∞–¥–∞—á–∏ (FR-7.2)
   - –ü–æ–∏—Å–∫ –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
   - –ê—É–¥–∏—Ç –∏ –æ—Ç—á–µ—Ç–Ω–æ—Å—Ç—å

---

## –ü—Ä–∏–Ω—Ü–∏–ø—ã –ø—Ä–æ–µ–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–µ–≤

### 1. –û–¥–∏–Ω —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π = –æ–¥–∏–Ω Aggregate Root

```python
# ‚úÖ –ü—Ä–∞–≤–∏–ª—å–Ω–æ
class TaskRepository:
    def get_by_id(self, task_id: int) -> Task:
        # –ó–∞–≥—Ä—É–∂–∞–µ—Ç Task —Å–æ –≤—Å–µ–º–∏ –¥–æ—á–µ—Ä–Ω–∏–º–∏ —Å—É—â–Ω–æ—Å—Ç—è–º–∏
        pass

# ‚ùå –ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ (–µ—Å–ª–∏ Comment - —á–∞—Å—Ç—å –∞–≥—Ä–µ–≥–∞—Ç–∞ Task)
class CommentRepository:
    def save(self, comment: Comment) -> None:
        # –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –¥–æ–ª–∂–Ω–æ –∏–¥—Ç–∏ —á–µ—Ä–µ–∑ TaskRepository
        pass
```

### 2. –î–æ—á–µ—Ä–Ω–∏–µ —Å—É—â–Ω–æ—Å—Ç–∏ –º–æ–≥—É—Ç –∏–º–µ—Ç—å —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–∏ –¥–ª—è –ø–æ–∏—Å–∫–∞

```python
# ‚úÖ –ü—Ä–∞–≤–∏–ª—å–Ω–æ - –¥–ª—è –ø–æ–∏—Å–∫–∞
class CommentRepository:
    def find_by_task_id(self, task_id: int) -> List[Comment]:
        # –ü–æ–∏—Å–∫ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–µ–≤ –∑–∞–¥–∞—á–∏
        pass
    
    def find_by_user_id(self, user_id: int) -> List[Comment]:
        # –ü–æ–∏—Å–∫ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–µ–≤ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
        pass

# –ù–æ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ —á–µ—Ä–µ–∑ TaskRepository
class TaskRepository:
    def save(self, task: Task) -> None:
        # –°–æ—Ö—Ä–∞–Ω—è–µ—Ç Task –∏ –≤—Å–µ –µ–≥–æ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏
        pass
```

### 3. –†–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π –Ω–µ –¥–æ–ª–∂–µ–Ω –≤–æ–∑–≤—Ä–∞—â–∞—Ç—å –¥–æ—á–µ—Ä–Ω–∏–µ —Å—É—â–Ω–æ—Å—Ç–∏ –±–µ–∑ Aggregate Root

```python
# ‚úÖ –ü—Ä–∞–≤–∏–ª—å–Ω–æ
task = task_repository.get_by_id(task_id)
comments = task.comments  # –ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏ –∑–∞–≥—Ä—É–∂–µ–Ω—ã –≤–º–µ—Å—Ç–µ —Å –∑–∞–¥–∞—á–µ–π

# ‚ö†Ô∏è –ú–æ–∂–Ω–æ, –Ω–æ –æ—Å—Ç–æ—Ä–æ–∂–Ω–æ
comments = comment_repository.find_by_task_id(task_id)  # –¢–æ–ª—å–∫–æ –¥–ª—è –ø–æ–∏—Å–∫–∞

# ‚ùå –ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ
comment = comment_repository.get_by_id(comment_id)  # Comment –±–µ–∑ Task - –ø–ª–æ—Ö–æ
```

---

## –ú–µ—Ç–æ–¥—ã —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–µ–≤

### TaskRepository (Aggregate Root)

```python
class TaskRepository(ABC):
    @abstractmethod
    def save(self, task: Task) -> None:
        """–°–æ—Ö—Ä–∞–Ω–∏—Ç—å –∑–∞–¥–∞—á—É (—Å–æ –≤—Å–µ–º–∏ –¥–æ—á–µ—Ä–Ω–∏–º–∏ —Å—É—â–Ω–æ—Å—Ç—è–º–∏)."""
        pass
    
    @abstractmethod
    def get_by_id(self, task_id: int) -> Optional[Task]:
        """–ü–æ–ª—É—á–∏—Ç—å –∑–∞–¥–∞—á—É –ø–æ ID."""
        pass
    
    @abstractmethod
    def find_all(
        self,
        status: Optional[TaskStatus] = None,
        assignee_id: Optional[int] = None,
        creator_id: Optional[int] = None,
        search_query: Optional[str] = None,
        limit: int = 50,
        offset: int = 0,
    ) -> List[Task]:
        """–ù–∞–π—Ç–∏ –∑–∞–¥–∞—á–∏ –ø–æ —Ñ–∏–ª—å—Ç—Ä–∞–º (FR-6.1)."""
        pass
    
    @abstractmethod
    def delete(self, task_id: int) -> None:
        """–£–¥–∞–ª–∏—Ç—å –∑–∞–¥–∞—á—É (–º—è–≥–∫–æ–µ —É–¥–∞–ª–µ–Ω–∏–µ - –∞—Ä—Ö–∏–≤–∞—Ü–∏—è)."""
        pass
    
    @abstractmethod
    def next_id(self) -> int:
        """–ü–æ–ª—É—á–∏—Ç—å —Å–ª–µ–¥—É—é—â–∏–π ID –¥–ª—è –Ω–æ–≤–æ–π –∑–∞–¥–∞—á–∏."""
        pass
```

### UserRepository (Aggregate Root)

```python
class UserRepository(ABC):
    @abstractmethod
    def save(self, user: User) -> None:
        """–°–æ—Ö—Ä–∞–Ω–∏—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è."""
        pass
    
    @abstractmethod
    def get_by_id(self, user_id: int) -> Optional[User]:
        """–ü–æ–ª—É—á–∏—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –ø–æ ID."""
        pass
    
    @abstractmethod
    def find_by_email(self, email: Email) -> Optional[User]:
        """–ù–∞–π—Ç–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –ø–æ email."""
        pass
    
    @abstractmethod
    def find_all(self, limit: int = 50, offset: int = 0) -> List[User]:
        """–ù–∞–π—Ç–∏ –≤—Å–µ—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π."""
        pass
```

### CommentRepository (–¥–ª—è –ø–æ–∏—Å–∫–∞)

```python
class CommentRepository(ABC):
    @abstractmethod
    def find_by_task_id(self, task_id: int) -> List[Comment]:
        """–ù–∞–π—Ç–∏ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏ –∑–∞–¥–∞—á–∏."""
        pass
    
    @abstractmethod
    def find_by_user_id(self, user_id: int) -> List[Comment]:
        """–ù–∞–π—Ç–∏ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è."""
        pass
    
    @abstractmethod
    def search(self, query: str) -> List[Comment]:
        """–ü–æ–∏—Å–∫ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–µ–≤ –ø–æ –∫–ª—é—á–µ–≤—ã–º —Å–ª–æ–≤–∞–º (FR-6.1)."""
        pass
```

### TimeLogRepository (–¥–ª—è –∞–Ω–∞–ª–∏—Ç–∏–∫–∏)

```python
class TimeLogRepository(ABC):
    @abstractmethod
    def find_by_task_id(self, task_id: int) -> List[TimeLog]:
        """–ù–∞–π—Ç–∏ –∑–∞–ø–∏—Å–∏ –≤—Ä–µ–º–µ–Ω–∏ –∑–∞–¥–∞—á–∏."""
        pass
    
    @abstractmethod
    def get_total_duration(self, task_id: int) -> Duration:
        """–ü–æ–ª—É—á–∏—Ç—å —Å—É–º–º–∞—Ä–Ω–æ–µ –≤—Ä–µ–º—è –ø–æ –∑–∞–¥–∞—á–µ (FR-2.2)."""
        pass
    
    @abstractmethod
    def find_by_user_id(self, user_id: int) -> List[TimeLog]:
        """–ù–∞–π—Ç–∏ –∑–∞–ø–∏—Å–∏ –≤—Ä–µ–º–µ–Ω–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è."""
        pass
```

---

## –ß—Ç–æ –µ—â–µ –º–æ–∂–µ—Ç –±—ã—Ç—å –Ω—É–∂–Ω–æ?

### 1. –°–ø–µ—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–∏ –¥–ª—è –ø–æ–∏—Å–∫–∞

–ï—Å–ª–∏ –Ω—É–∂–µ–Ω —Å–ª–æ–∂–Ω—ã–π –ø–æ–∏—Å–∫, –º–æ–∂–Ω–æ —Å–æ–∑–¥–∞—Ç—å —Å–ø–µ—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–∏:

```python
# –î–ª—è —Å–ª–æ–∂–Ω—ã—Ö –∑–∞–ø—Ä–æ—Å–æ–≤ –ø–æ–∏—Å–∫–∞ (FR-6.1)
class TaskSearchRepository(ABC):
    @abstractmethod
    def search(
        self,
        query: str,
        status: Optional[TaskStatus] = None,
        assignee_id: Optional[int] = None,
    ) -> List[Task]:
        """–ü–æ–∏—Å–∫ –∑–∞–¥–∞—á –ø–æ –∫–ª—é—á–µ–≤—ã–º —Å–ª–æ–≤–∞–º –≤ title, description, comments."""
        pass
```

### 2. –†–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π –¥–ª—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏

```python
class TaskStatisticsRepository(ABC):
    @abstractmethod
    def get_task_count_by_status(self, user_id: int) -> Dict[TaskStatus, int]:
        """–ü–æ–ª—É—á–∏—Ç—å –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∑–∞–¥–∞—á –ø–æ —Å—Ç–∞—Ç—É—Å–∞–º –¥–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è."""
        pass
    
    @abstractmethod
    def get_total_time_spent(self, user_id: int) -> Duration:
        """–ü–æ–ª—É—á–∏—Ç—å –æ–±—â–µ–µ –≤—Ä–µ–º—è, –∑–∞—Ç—Ä–∞—á–µ–Ω–Ω–æ–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–º."""
        pass
```

---

## –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –¥–ª—è –Ω–∞—à–µ–≥–æ –ø—Ä–æ–µ–∫—Ç–∞

### ‚úÖ –û—Å—Ç–∞–≤–∏—Ç—å –≤—Å–µ —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–µ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–∏:

1. **TaskRepository** - –æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ (Aggregate Root)
2. **UserRepository** - –æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ (Aggregate Root)
3. **CommentRepository** - –¥–ª—è –ø–æ–∏—Å–∫–∞ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–µ–≤ (FR-6.1)
4. **AttachmentRepository** - –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å —Ñ–∞–π–ª–∞–º–∏ –∏ –ø—Ä–æ–≤–µ—Ä–∫–∏ –ª–∏–º–∏—Ç–∞
5. **TimeLogRepository** - –¥–ª—è –∞–Ω–∞–ª–∏—Ç–∏–∫–∏ –≤—Ä–µ–º–µ–Ω–∏ (FR-2.2)
6. **ActivityRepository** - –¥–ª—è audit log (FR-7.2)

### ‚ö†Ô∏è –ü–µ—Ä–µ–∏–º–µ–Ω–æ–≤–∞—Ç—å –∏–ª–∏ —É—Ç–æ—á–Ω–∏—Ç—å:

- **auth_storage.py** - —ç—Ç–æ –Ω–µ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π Entity, —ç—Ç–æ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å –¥–ª—è –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏
  - –ú–æ–∂–Ω–æ –æ—Å—Ç–∞–≤–∏—Ç—å –∫–∞–∫ –µ—Å—Ç—å
  - –ò–ª–∏ –ø–µ—Ä–µ–∏–º–µ–Ω–æ–≤–∞—Ç—å –≤ `authentication_storage.py`

### üìã –í–æ–∑–º–æ–∂–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å –≤ –±—É–¥—É—â–µ–º:

- **TaskSearchRepository** - –µ—Å–ª–∏ –ø–æ–∏—Å–∫ —Å—Ç–∞–Ω–µ—Ç —Å–ª–æ–∂–Ω—ã–º
- **TaskStatisticsRepository** - –µ—Å–ª–∏ –Ω—É–∂–Ω–∞ –∞–Ω–∞–ª–∏—Ç–∏–∫–∞

---

## –ò—Ç–æ–≥–æ–≤–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞

```
src/interfaces/repositories/
‚îú‚îÄ‚îÄ task_repository.py          ‚úÖ Aggregate Root
‚îú‚îÄ‚îÄ user_repository.py          ‚úÖ Aggregate Root
‚îú‚îÄ‚îÄ comment_repository.py       ‚ö†Ô∏è –î–ª—è –ø–æ–∏—Å–∫–∞
‚îú‚îÄ‚îÄ attachment_repository.py    ‚ö†Ô∏è –î–ª—è —Ä–∞–±–æ—Ç—ã —Å —Ñ–∞–π–ª–∞–º–∏
‚îú‚îÄ‚îÄ time_log_repository.py      ‚ö†Ô∏è –î–ª—è –∞–Ω–∞–ª–∏—Ç–∏–∫–∏
‚îú‚îÄ‚îÄ activity_repository.py      ‚ö†Ô∏è –î–ª—è audit log
‚îî‚îÄ‚îÄ auth_storage.py             ‚ö†Ô∏è –ù–µ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π Entity (–∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è)
```

---

**–í—ã–≤–æ–¥:** –¢–≤–æ—è –∏–Ω—Ç—É–∏—Ü–∏—è –±—ã–ª–∞ –ø—Ä–∞–≤–∏–ª—å–Ω–æ–π! –í—Å–µ –æ—Å–Ω–æ–≤–Ω—ã–µ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–∏ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω—ã –≤–µ—Ä–Ω–æ. –ï–¥–∏–Ω—Å—Ç–≤–µ–Ω–Ω–æ–µ —É—Ç–æ—á–Ω–µ–Ω–∏–µ - `auth_storage.py` —ç—Ç–æ –Ω–µ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π Entity, –∞ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å –¥–ª—è –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏.

