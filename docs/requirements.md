# 1. Функциональные требования
## 1.1. Управление задачами (Tasks)

### FR-1.1: 
Пользователь может создать задачу с полями:

- title (обязательно, строка ≤ 255 символов)

- description (опционально, текст)

- status (один из: created, in_progress, paused, completed, cancelled)
- assignee_id — ссылка на пользователя (nullable; если не задан — создающий становится исполнителем)
- creator_id — ссылка на пользователя
- created_at, updated_at — автоматически

### FR-1.2: 
Пользователь может изменить:

- title, description, assignee_id, status
изменения разрешены только автору, исполнителю или администратору

### FR-1.3: 
Задача может быть удалена или помечена как archived (мягкое удаление)

### FR-1.4: 
Поддержка прикрепления нескольких файлов (см. 1.4)

## 1.2. Временные затраты (Time Logs)

### FR-2.1: 
Пользователь может добавлять записи о затраченном времени к задаче:
- duration_seconds (целое число)
- comment (опционально)
- logged_by_id — ссылка на пользователя
- logged_at — дата/время

### FR-2.2: 

Возможность просмотра суммарного времени по задаче

## 1.3. Комментарии (Comments)
### FR-3.1:
Любой авторизованный пользователь может добавлять комментарии к задаче

### FR-3.2: 
Комментарии неизменяемы после создания (или можно реализовать редактирование с историей — по желанию)

### FR-3.3: 
Комментарии отображаются в хронологическом порядке

## 1.4. Файлы (Attachments)
### FR-4.1: 
Пользователь может прикреплять файлы к задаче (макс. N файлов, например 10)

### FR-4.2: 
Поддерживаемые форматы: .pdf, .txt, .docx, .png, .jpg, .jpeg

### FR-4.3: 
Файлы хранятся на диске или в объектном хранилище (например, локально в uploads/), в БД — только метаданные:
filename, content_type, size_bytes, storage_path, task_id

## 1.5. Назначение и права доступа

### FR-5.1: 
Только creator, assignee или admin могут:
- менять статус задачи
- редактировать описание/заголовок

### FR-5.2: 
Только creator или admin могут:
- удалять/архивировать задачу
- назначать нового исполнителя
### FR-5.3: 
Любой авторизованный пользователь может:
- комментировать
- просматривать задачи (но не все — см. ниже)

## 1.6. Поиск и фильтрация
### FR-6.1: 
Пользователь может просматривать список задач с фильтрацией по:
- статусу
- исполнителю (me / конкретный пользователь)
- дате создания
- ключевым словам (в title, description, comments)

### FR-6.2: 
Поддержка постраничной навигации (pagination)

## 1.7. История изменений (Audit Log)
### FR-7.1: 
Система сохраняет журнал событий по задаче:
- кто изменил статус
- кто добавил комментарий/файл
- когда задача была создана/назначена/архивирована

### FR-7.2: 
Доступен через API или UI как “история активности”

## 1.8. Уведомления (через RabbitMQ)
### FR-8.1:
При следующих событиях публикуется сообщение в RabbitMQ:
- новая задача назначена пользователю
- добавлен комментарий к задаче
- изменён статус задачи

### FR-8.2: 
Сообщение содержит:
- event_type (например, task_assigned, comment_added)
- user_id получателя
- task_id
- timestamp
- (опционально) краткий текст для email/UI

### FR-8.3: 
Отдельный consumer (воркер на Python) может обрабатывать эти сообщения для:
- отправки email
- записи в “централизованную ленту уведомлений”
- логирования

# 2. Нефункциональные требования
## 2.1. Масштабируемость и производительность
### NFR-2.1: 
Система должна поддерживать до 100 одновременных пользователей

### NFR-2.2: 
Ответ API ≤ 500 мс при типичной нагрузке

### NFR-2.3: 
Поддержка горизонтального масштабирования воркеров RabbitMQ

## 2.2. Безопасность
### NFR-2.4: 
Все API защищены аутентификацией (JWT или сессии)

### NFR-2.5: 
Проверка прав доступа на уровне бизнес-логики (не только UI)

### NFR-2.6: 
Загрузка файлов проходит валидацию по MIME-типу и расширению

## 2.3. Надёжность
### NFR-2.7: 
Использовать транзакции SQLAlchemy для целостности данных

### NFR-2.8: 
RabbitMQ сообщения публикуются с подтверждением (publisher confirms)

### NFR-2.9: 
Обработка ошибок в воркерах: повтор при сбое (retry with backoff)

## 2.4. Архитектура
### NFR-2.10: 
Чёткое разделение:
- Web-сервер (FastAPI/Flask)
- База данных (PostgreSQL через SQLAlchemy)
- Очередь (RabbitMQ через aio-pika или pika)

### NFR-2.11: 
Поддержка миграций БД (Alembic)